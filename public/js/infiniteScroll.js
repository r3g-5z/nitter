// @license http://www.gnu.org/licenses/agpl-3.0.html AGPL-3.0
function insertBeforeLast(e,t){e.insertBefore(t,e.childNodes[e.childNodes.length-2])}function getLoadMore(e){return e.querySelector(".show-more:not(.timeline-item)")}function isDuplicate(e,t){const n=e.querySelector(".tweet-link");if(null===n)return!1;const o=n.getAttribute("href");return null!==document.querySelector(t+" .tweet-link[href='"+o+"']")}window.onload=function(){const e=-1!==window.location.pathname.indexOf("/status/"),t=e?".replies":".timeline",n=t+" > div:not(.top-ref)";let o=document.querySelector("html"),r=document.querySelector(t),i=!1;window.addEventListener("scroll",(function(){if(!i&&o.scrollTop+o.clientHeight>=o.scrollHeight-3e3){i=!0;let t=getLoadMore(document);if(null===t)return;t.children[0].text="Loading...";let o=new URL(t.children[0].href);o.searchParams.append("scroll","true"),fetch(o.toString()).then((function(e){return e.text()})).then((function(o){let l=(new DOMParser).parseFromString(o,"text/html");for(let o of(t.remove(),l.querySelectorAll(n)))"timeline-item show-more"!==o.className&&(isDuplicate(o,n)||(e?r.appendChild(o):insertBeforeLast(r,o)));i=!1;const c=getLoadMore(l);null!==c&&(e?r.appendChild(c):insertBeforeLast(r,c))})).catch((function(e){console.warn("Something went wrong.",e),i=!0}))}}))};
// @license-end