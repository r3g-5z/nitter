function insertBeforeLast(e,t){e.insertBefore(t,e.childNodes[e.childNodes.length-2])}function getLoadMore(e){return e.querySelector(".show-more:not(.timeline-item)")}function isDuplicate(e,t){const n=e.querySelector(".tweet-link");if(null==n)return!1;const r=n.getAttribute("href");return null!=document.querySelector(t+" .tweet-link[href='"+r+"']")}window.onload=function(){const e=-1!==window.location.pathname.indexOf("/status/"),t=e?".replies":".timeline",n=t+" > div:not(.top-ref)";var r=document.querySelector("html"),o=document.querySelector(t),i=!1;window.addEventListener("scroll",(function(){if(!i&&r.scrollTop+r.clientHeight>=r.scrollHeight-3e3){i=!0;var t=getLoadMore(document);if(null==t)return;t.children[0].text="Loading...";var l=new URL(t.children[0].href);l.searchParams.append("scroll","true"),fetch(l.toString()).then((function(e){return e.text()})).then((function(r){var l=(new DOMParser).parseFromString(r,"text/html");for(var c of(t.remove(),l.querySelectorAll(n)))"timeline-item show-more"!=c.className&&(isDuplicate(c,n)||(e?o.appendChild(c):insertBeforeLast(o,c)));i=!1;const a=getLoadMore(l);null!=a&&(e?o.appendChild(a):insertBeforeLast(o,a))})).catch((function(e){console.warn("Something went wrong.",e),i=!0}))}}))};